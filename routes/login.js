const _0xbc694a=_0x5c7d;(function(_0x1811c2,_0x11cca6){const _0x545892=_0x5c7d,_0xf1bf27=_0x1811c2();while(!![]){try{const _0x40b995=-parseInt(_0x545892(0x1c1))/0x1*(-parseInt(_0x545892(0x1f8))/0x2)+-parseInt(_0x545892(0x1b3))/0x3*(parseInt(_0x545892(0x1dc))/0x4)+parseInt(_0x545892(0x1bd))/0x5*(-parseInt(_0x545892(0x1e2))/0x6)+-parseInt(_0x545892(0x1c7))/0x7+-parseInt(_0x545892(0x1d4))/0x8*(parseInt(_0x545892(0x1d1))/0x9)+-parseInt(_0x545892(0x1b7))/0xa*(-parseInt(_0x545892(0x1eb))/0xb)+-parseInt(_0x545892(0x1e9))/0xc*(-parseInt(_0x545892(0x1db))/0xd);if(_0x40b995===_0x11cca6)break;else _0xf1bf27['push'](_0xf1bf27['shift']());}catch(_0x3e841d){_0xf1bf27['push'](_0xf1bf27['shift']());}}}(_0x1b37,0x9cce5));var express=require('express'),bcrypt=require(_0xbc694a(0x1b2)),router=express['Router'](),knex=require('../database');const {body,validationResult}=require(_0xbc694a(0x1f2));var localStorage=require(_0xbc694a(0x1f4));const tough=require(_0xbc694a(0x1bf)),Cookie=tough[_0xbc694a(0x1ba)],log4js=require('log4js');log4js[_0xbc694a(0x1c0)]({'appenders':{'everything':{'type':_0xbc694a(0x1d0),'filename':_0xbc694a(0x1e4)}},'categories':{'default':{'appenders':[_0xbc694a(0x1c6)],'level':_0xbc694a(0x1d5)}}});function _0x5c7d(_0x5045a6,_0x5bccb1){const _0x1b374d=_0x1b37();return _0x5c7d=function(_0x5c7da1,_0x8c2985){_0x5c7da1=_0x5c7da1-0x1b2;let _0x106108=_0x1b374d[_0x5c7da1];return _0x106108;},_0x5c7d(_0x5045a6,_0x5bccb1);}const loggers=log4js[_0xbc694a(0x1f1)]();function _0x1b37(){const _0x204d52=['isEmpty','file','45IYVZTI','tbl_users','/logout','1414216RWdeYL','ALL','debug','check_session','commit','../middlewares/auth','Success\x20Logout','1053ONEJgH','140084enrTqu','post','flash','body','Corect,\x20Password\x20Wrong','success','5910UwzOVO','transaction','logs.log','role','Success\x20Login\x20','where','Correct\x20Email,\x20Email\x20Not\x20Found','366540poEXSg','info','264814siQxTl','get','exports','render','cookies','errors','getLogger','express-validator','cookie','localStorage','redirect','ERROR','notEmpty','6HxYxdL','backend/login','bcrypt','105PXnhYT','username','backend/home','values','350nwVRHG','email','/login','Cookie','log','/auth','355ykNbzI','Error\x20Logout\x20','tough-cookie','configure','199590znSHvJ','fatal','token','session','rollback','everything','7655711RBJNlX','error','password','compareSync','length','catch','mapped','then'];_0x1b37=function(){return _0x204d52;};return _0x1b37();}var Auth_mdw=require(_0xbc694a(0x1d9));router[_0xbc694a(0x1ec)]('/',Auth_mdw[_0xbc694a(0x1d7)],function(_0x47eaff,_0x2bca83,_0xab14c){const _0x37002f=_0xbc694a;return _0x2bca83[_0x37002f(0x1ee)](_0x37002f(0x1f9),{'success':_0x47eaff[_0x37002f(0x1de)](_0x37002f(0x1e1)),'errors':_0x47eaff[_0x37002f(0x1de)](_0x37002f(0x1f0))});}),router[_0xbc694a(0x1dd)](_0xbc694a(0x1bc),[body(_0xbc694a(0x1b8))[_0xbc694a(0x1f7)](),body(_0xbc694a(0x1c9))[_0xbc694a(0x1f7)]()],async(_0xf7faa4,_0x438abf)=>{const _0x490c1b=_0xbc694a,_0x564b97=validationResult(_0xf7faa4)['formatWith'](({msg:_0x2f2775})=>{return _0x2f2775;});!_0x564b97[_0x490c1b(0x1cf)]()&&(loggers['info'](_0x490c1b(0x1f0),Object['values'](_0x564b97[_0x490c1b(0x1cd)]())),_0xf7faa4['flash'](_0x490c1b(0x1f0),Object[_0x490c1b(0x1b6)](_0x564b97[_0x490c1b(0x1cd)]())),_0x438abf['redirect'](_0x490c1b(0x1b9))),knex[_0x490c1b(0x1e3)](function(_0x2a006a){const _0x5286a5=_0x490c1b;knex(_0x5286a5(0x1d2))[_0x5286a5(0x1e7)]({'email':_0xf7faa4[_0x5286a5(0x1df)]['email']})['select']('*')['then']()[_0x5286a5(0x1ce)](_0x2a006a[_0x5286a5(0x1d8)])[_0x5286a5(0x1cc)](_0x2a006a[_0x5286a5(0x1c5)]);})[_0x490c1b(0x1ce)](function(_0x577ee0){const _0x5398d4=_0x490c1b;if(_0x577ee0[_0x5398d4(0x1cb)]!==0x1)loggers['info']('errors',_0x5398d4(0x1e8)),_0xf7faa4[_0x5398d4(0x1de)]('errors',_0x5398d4(0x1e8)),_0x438abf[_0x5398d4(0x1f5)]('/login');else{const _0x127ba9=bcrypt[_0x5398d4(0x1ca)](_0xf7faa4[_0x5398d4(0x1df)][_0x5398d4(0x1c9)],_0x577ee0[0x0][_0x5398d4(0x1c9)]);!_0x127ba9?(loggers[_0x5398d4(0x1ea)](_0x5398d4(0x1f0),_0x5398d4(0x1e0)),_0xf7faa4[_0x5398d4(0x1de)](_0x5398d4(0x1f0),_0x5398d4(0x1e0)),_0x438abf[_0x5398d4(0x1f5)](_0x5398d4(0x1b9))):(_0xf7faa4[_0x5398d4(0x1c4)]['loggedin']=!![],_0xf7faa4['session'][_0x5398d4(0x1b8)]=_0xf7faa4[_0x5398d4(0x1df)][_0x5398d4(0x1b8)],_0xf7faa4['session'][_0x5398d4(0x1e5)]=_0x577ee0[0x0][_0x5398d4(0x1e5)],_0xf7faa4['session'][_0x5398d4(0x1b4)]=_0x577ee0[0x0]['username'],console[_0x5398d4(0x1bb)](_0xf7faa4[_0x5398d4(0x1c4)][_0x5398d4(0x1b4)]),_0x438abf[_0x5398d4(0x1f3)](_0x5398d4(0x1c3),_0xf7faa4['body'][_0x5398d4(0x1b8)],{'expires':new Date(Date['now']()+0xdbba0),'httpOnly':!![]}),loggers[_0x5398d4(0x1d6)](_0x5398d4(0x1e6)+_0xf7faa4[_0x5398d4(0x1df)][_0x5398d4(0x1b8)]),console['log'](_0xf7faa4[_0x5398d4(0x1ef)]),_0x438abf['render'](_0x5398d4(0x1b5),{'emails':_0xf7faa4[_0x5398d4(0x1c4)]['email'],'username':_0xf7faa4['session'][_0x5398d4(0x1b4)],'role':_0xf7faa4['session']['role']}));}})[_0x490c1b(0x1cc)](function(_0x51e46d){const _0x3f60cb=_0x490c1b;loggers[_0x3f60cb(0x1c2)](_0x3f60cb(0x1f6)+_0x51e46d),console[_0x3f60cb(0x1bb)](_0x51e46d);});}),router[_0xbc694a(0x1ec)](_0xbc694a(0x1d3),function(_0x34f5e0,_0x2cb78b){_0x34f5e0['session']['destroy'](function(_0x254a29){const _0xfb1d36=_0x5c7d;_0x254a29?(console['log'](_0x254a29),loggers[_0xfb1d36(0x1c8)](_0xfb1d36(0x1be)+_0x254a29)):(loggers[_0xfb1d36(0x1d6)](_0xfb1d36(0x1da)),_0x2cb78b[_0xfb1d36(0x1f5)]('/'));});}),module[_0xbc694a(0x1ed)]=router;